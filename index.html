<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯</title>
    
    <!-- Ù„ÛŒÙ†Ú© Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- Ù„ÛŒÙ†Ú© ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ù‡Ù†Ø±ÛŒ Ùˆ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø§Ø² Ú¯ÙˆÚ¯Ù„ -->
    <link href="https://fonts.googleapis.com/css2?family=Lalezar&family=Vazirmatn:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #6B8E23; 
            --dark-green: #3A5210;
            --gold: #F2C94C;
            --light-bg: #f8f9fa;      
            --selected-bg: #eef5e0;   
            --text-color: #444;
            --border-radius: 20px;
            --shadow: 0 10px 30px rgba(0,0,0,0.08); 
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            margin: 0;
            padding: 0 0 100px 0;
            background-color: var(--light-bg);
            color: var(--text-color);
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent; /* Ø­Ø°Ù Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ø¢Ø¨ÛŒ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        }

        /* --- Ù‡Ø¯Ø± Ù„Ø§Ú©Ú†Ø±ÛŒ --- */
        .header {
            position: relative;
            background: linear-gradient(135deg, #557C18 0%, #2d420b 100%);
            padding: 40px 20px 70px 20px;
            border-radius: 0 0 40px 40px;
            text-align: center;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(45, 66, 11, 0.3);
            z-index: 10;
        }
        .header::before, .header::after {
            content: ''; position: absolute; border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            z-index: 1; pointer-events: none;
        }
        .header::before {
            width: 200px; height: 200px; top: -50px; left: -50px;
            animation: floatOrb 10s ease-in-out infinite alternate;
        }
        .header::after {
            width: 150px; height: 150px; bottom: 20px; right: -30px;
            background: rgba(255, 215, 0, 0.1);
            animation: floatOrb 8s ease-in-out infinite alternate-reverse;
        }
        .header-bg-icon {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10rem; color: rgba(255,255,255,0.03);
            z-index: 0; pointer-events: none;
        }
        .header h1 {
            font-family: 'Lalezar', cursive;
            margin: 0; font-size: 3.5rem; color: #fff;
            text-shadow: 0 4px 15px rgba(0,0,0,0.3);
            position: relative; z-index: 2; letter-spacing: 1px;
            animation: fadeInDown 1s ease-out;
        }
        .header p {
            font-family: 'Vazirmatn', sans-serif; font-weight: 300;
            margin: 5px 0 0; color: rgba(255, 255, 255, 0.85); 
            font-size: 1rem; position: relative; z-index: 2;
            animation: fadeInUp 1s ease-out 0.3s backwards;
        }

        @keyframes floatOrb { 0% { transform: translate(0, 0); } 100% { transform: translate(20px, 30px); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ --- */
        .container { padding: 0 20px 20px; max-width: 1200px; margin: 0 auto; }
        
        /* --- Ø¬Ø³ØªØ¬Ùˆ --- */
        .search-container { 
            position: relative; margin-top: -35px; margin-bottom: 35px; z-index: 20; 
        }
        #search-input {
            width: 100%; padding: 18px 50px 18px 20px; font-size: 1.1rem;
            font-family: 'Vazirmatn', sans-serif; border-radius: 50px; border: none;
            background-color: #fff; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease; color: #555; box-sizing: border-box;
        }
        #search-input:focus { outline: none; transform: translateY(-2px); box-shadow: 0 15px 30px rgba(107, 142, 35, 0.25); }
        .search-icon {
            position: absolute; right: 25px; top: 50%; transform: translateY(-50%);
            color: var(--primary-color); font-size: 1.3rem; pointer-events: none;
        }

        /* --- Ú¯Ø±ÛŒØ¯ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ --- */
        .categories-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
            gap: 18px; padding-bottom: 20px; 
        }
        @media (min-width: 480px) {
             .categories-grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        }

        .category-tile {
            position: relative; color: white; border-radius: 25px; overflow: hidden;
            text-decoration: none; display: flex; flex-direction: column; justify-content: center;
            align-items: center; height: 170px; padding: 10px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); 
            cursor: pointer;
        }
        
        /* Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ø§Ø´ÛŒâ€ŒÙ‡Ø§ */
        .cat-special { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); box-shadow: 0 10px 20px rgba(32, 58, 67, 0.3); border: 1px solid rgba(255,255,255,0.1); } /* Ú©Ø§Ø´ÛŒ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ */
        .cat-mixer { background: linear-gradient(135deg, #DA22FF 0%, #9733EE 100%); box-shadow: 0 10px 20px rgba(218, 34, 255, 0.3); } /* Ú©Ø§Ø´ÛŒ Ù…ÛŒÚ©Ø³Ø± */
        
        .cat-herbs { background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%); box-shadow: 0 10px 20px rgba(86, 171, 47, 0.3); }
        .cat-spices { background: linear-gradient(135deg, #ff512f 0%, #dd2476 100%); box-shadow: 0 10px 20px rgba(221, 36, 118, 0.3); }
        .cat-liquids { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3); }
        .cat-oils { background: linear-gradient(135deg, #f09819 0%, #edde5d 100%); box-shadow: 0 10px 20px rgba(240, 152, 25, 0.3); }
        .cat-grains { background: linear-gradient(135deg, #EB3349 0%, #F45C43 100%); box-shadow: 0 10px 20px rgba(235, 51, 73, 0.3); }
        .cat-hygiene { background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%); box-shadow: 0 10px 20px rgba(142, 45, 226, 0.3); }
        .cat-food { background: linear-gradient(135deg, #FF8008 0%, #FFC837 100%); box-shadow: 0 10px 20px rgba(255, 128, 8, 0.3); }
        .cat-misc { background: linear-gradient(135deg, #6190E8 0%, #A7BFE8 100%); box-shadow: 0 10px 20px rgba(97, 144, 232, 0.3); }

        .category-tile::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(255,255,255,0.1), transparent); }
        .category-tile:hover { transform: translateY(-8px) scale(1.03); }
        .tile-content { position: relative; z-index: 2; text-align: center; width: 100%; }
        .tile-content i { font-size: 3.2rem; margin-bottom: 10px; display: inline-block; color: #fff; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.2)); transition: all 0.3s ease; }
        .tile-content h2 { font-family: 'Lalezar', cursive; margin: 0; font-size: 1.5rem; text-shadow: 0 2px 5px rgba(0,0,0,0.2); letter-spacing: 0.5px; }
        
        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø´ÛŒ */
        @keyframes bounce-c { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        .category-tile:hover i { animation: bounce-c 0.6s ease; }

        /* --- Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ (Ù…Ø´ØªØ±Ú©) --- */
        .inner-section { display: none; margin-top: 20px; background-color: white; padding: 25px; border-radius: 25px; box-shadow: var(--shadow); }
        .back-btn { 
            background-color: #f0f2f5; color: #555; border: none; padding: 12px 20px; 
            border-radius: 15px; cursor: pointer; font-size: 0.95rem; font-family: 'Vazirmatn', sans-serif; font-weight: 700;
            margin-bottom: 25px; display: inline-flex; align-items: center; gap: 10px; transition: all 0.2s;
        }
        .back-btn:hover { background-color: #e2e6ea; color: var(--primary-color); }

        /* --- Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª --- */
        .product-list { list-style: none; padding: 0; margin: 0; }
        .product-item {
            display: grid; grid-template-columns: auto 1fr auto; align-items: center;
            gap: 15px; padding: 15px 10px; border-bottom: 1px solid #f4f4f4;
            transition: background-color 0.2s; border-radius: 12px; margin-bottom: 5px;
        }
        .product-item.selected { background-color: var(--selected-bg); border: 1px solid var(--primary-color); }
        .product-name { font-weight: 500; font-size: 1.1rem; cursor: pointer; color: #333; }
        .product-checkbox { width: 24px; height: 24px; cursor: pointer; accent-color: var(--primary-color); border-radius: 6px; }
        .quantity-input-container { display: none; align-items: center; justify-self: end; gap: 10px; }
        .product-item.selected .quantity-input-container { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        .quantity-input { width: 50px; padding: 5px; border: 2px solid #dce6c5; border-radius: 10px; text-align: center; font-size: 1.1rem; font-weight: bold; color: var(--primary-color); font-family: 'Vazirmatn', sans-serif; }
        .quantity-input:focus { outline: none; border-color: var(--primary-color); }
        .delete-btn { color: #ff4757; cursor: pointer; font-size: 1rem; background: #ffeef0; border-radius: 10px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .delete-btn:hover { background: #ff4757; color: white; }
        .status-badge { padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; }
        .status-unavailable { background-color: #fff0f0; color: #e03e2d; }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø®Ø´ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ --- */
        .special-form { display: flex; flex-direction: column; gap: 20px; }
        .form-group label { font-weight: bold; margin-bottom: 8px; display: block; color: var(--dark-green); }
        .form-control {
            width: 100%; padding: 15px; border: 2px solid #eee; border-radius: 15px;
            font-family: 'Vazirmatn', sans-serif; font-size: 1rem; transition: border 0.3s; box-sizing: border-box;
        }
        .form-control:focus { outline: none; border-color: var(--primary-color); }
        .btn-submit-special {
            background: linear-gradient(135deg, #203a43, #2c5364); color: white; padding: 15px;
            border: none; border-radius: 15px; font-size: 1.1rem; font-family: 'Lalezar', cursive;
            cursor: pointer; box-shadow: 0 5px 15px rgba(32, 58, 67, 0.2); margin-top: 10px;
        }
        .btn-submit-special:hover { transform: translateY(-2px); }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø®Ø´ Ù…Ú©Ù…Ù„ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ© (Ú¯ÛŒÙ…ÛŒÙÛŒÚ©ÛŒØ´Ù†) --- */
        .mixer-container { display: flex; flex-direction: column; gap: 20px; align-items: center; }
        
        /* Ø´Ù„Ù Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§ */
        .supplements-shelf {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
            background: #8B4513; padding: 15px; border-radius: 10px;
            width: 100%; box-sizing: border-box; box-shadow: inset 0 5px 10px rgba(0,0,0,0.3);
        }
        .supplement-jar {
            background-color: rgba(255,255,255,0.9); border-radius: 8px;
            height: 60px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: grab; user-select: none; position: relative; box-shadow: 0 3px 5px rgba(0,0,0,0.2);
        }
        .supplement-jar:active { cursor: grabbing; }
        .jar-lid { width: 20px; height: 5px; background: #555; margin-bottom: 2px; }
        .jar-body { width: 30px; height: 35px; border-radius: 5px; border: 1px solid #ccc; }
        .jar-label { font-size: 0.6rem; margin-top: 2px; color: #333; text-align: center; white-space: nowrap; overflow: hidden; width: 100%; }

        /* Ø¸Ø±Ù Ù…Ø®Ù„ÙˆØ· (Ø§Ø±Ù„Ù† Ù…Ø§ÛŒØ±) */
        .mixing-area {
            position: relative; width: 100%; height: 250px;
            display: flex; justify-content: center; align-items: flex-end;
            margin-top: 10px;
        }
        .flask-container {
            position: relative; width: 140px; height: 200px;
            display: flex; flex-direction: column-reverse; /* Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† Ù¾Ø± Ø´ÙˆÙ†Ø¯ */
            align-items: center;
        }
        .flask-glass {
            position: relative; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.15);
            border: 3px solid rgba(200, 200, 200, 0.5);
            /* Ø´Ú©Ù„ Ø§Ø±Ù„Ù† Ù…Ø§ÛŒØ± */
            clip-path: polygon(25% 0, 75% 0, 100% 100%, 0% 100%);
            overflow: hidden; /* Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø´ Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ */
            z-index: 2;
            backdrop-filter: blur(2px);
        }
        .flask-neck {
            position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
            width: 65px; height: 35px; background: rgba(255, 255, 255, 0.15);
            border: 3px solid rgba(200, 200, 200, 0.5); border-bottom: none;
            z-index: 1;
        }
        
        /* Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù¾ÙˆØ¯Ø± */
        .powder-layer { width: 100%; transition: height 0.3s ease-out; }

        /* Ù…ØªÙ† ÙˆØ²Ù† Ø±ÙˆÛŒ Ø¸Ø±Ù */
        .flask-stats {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.5rem; font-weight: bold; color: #333; text-shadow: 0 0 5px white;
            z-index: 10; pointer-events: none; font-family: 'Lalezar', cursive;
        }

        .completed-mixes {
            margin-top: 20px; width: 100%; border-top: 1px dashed #ccc; padding-top: 10px;
        }
        .mix-item {
            background: #f9f9f9; padding: 10px; border-radius: 10px; margin-bottom: 5px;
            display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem;
        }

        /* Ø§Ù„Ù…Ø§Ù† Ù…ØªØ­Ø±Ú© (Ghost) Ø¨Ø±Ø§ÛŒ ØªØ§Ú† */
        .drag-ghost {
            position: fixed; pointer-events: none; z-index: 9999;
            width: 50px; height: 50px; opacity: 0.8; border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); display: none;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; color: white; font-weight: bold;
        }

        /* --- Ø¯Ú©Ù…Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ --- */
        .whatsapp-fab {
            position: fixed; bottom: 25px; left: 25px; 
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white; width: 65px; height: 65px; border-radius: 50%; display: flex;
            justify-content: center; align-items: center; font-size: 2.5rem;
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4); text-decoration: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer; transform: scale(0); z-index: 1000;
        }
        .whatsapp-fab.visible { transform: scale(1); }
        .whatsapp-fab:hover { transform: scale(1.1) rotate(10deg); box-shadow: 0 15px 35px rgba(37, 211, 102, 0.5); }
        .cart-counter {
            position: absolute; top: 0; right: 0; background-color: #ff4757;
            color: white; border-radius: 50%; width: 24px; height: 24px;
            font-size: 0.8rem; font-weight: bold; display: flex;
            justify-content: center; align-items: center; border: 2px solid white;
        }

        #loading { text-align: center; padding: 40px; color: #888; }
    </style>
</head>
<body>

    <header class="header">
        <i class="fa-solid fa-leaf header-bg-icon"></i>
        <h1>ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯</h1>
        <p>Ø·Ø¨ÛŒØ¹Øª Ø±Ø§ Ø¨Ù‡ Ø®Ø§Ù†Ù‡ Ø®ÙˆØ¯ Ø¨ÛŒØ§ÙˆØ±ÛŒØ¯</p>
    </header>

    <div class="container">
        <div class="search-container">
            <i class="fa-solid fa-search search-icon"></i>
            <input type="search" id="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ (Ù…Ø«Ù„Ø§: Ø¢ÙˆÛŒØ´Ù†)..." autocomplete="off">
        </div>

        <!-- Ù†Ù…Ø§ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ -->
        <div id="category-view">
            <div class="categories-grid">
                
                <!-- Ú©Ø§Ø´ÛŒ Û±: Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ø®Ø§Øµ -->
                <div class="category-tile cat-special" onclick="showSection('special-request-view')">
                    <div class="tile-content"><i class="fa-solid fa-star"></i><h2>Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ø®Ø§Øµ</h2></div>
                </div>

                <!-- Ú©Ø§Ø´ÛŒ Û²: Ù…Ú©Ù…Ù„ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ© (Ø¨Ø§Ø²ÛŒ) -->
                <div class="category-tile cat-mixer" onclick="initMixer(); showSection('mixer-view')">
                    <div class="tile-content"><i class="fa-solid fa-flask"></i><h2>Ù…ÛŒÚ©Ø³ Ù…Ú©Ù…Ù„ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ©</h2></div>
                </div>

                <div class="category-tile cat-herbs" data-category="Ú¯ÛŒØ§Ù‡Ø§Ù†-Ø¯Ø§Ø±ÙˆÛŒÛŒ">
                    <div class="tile-content"><i class="fa-solid fa-leaf"></i><h2>Ú¯ÛŒØ§Ù‡Ø§Ù† Ø¯Ø§Ø±ÙˆÛŒÛŒ</h2></div>
                </div>
                <div class="category-tile cat-spices" data-category="Ø§Ø¯ÙˆÛŒÙ‡-Ø¬Ø§Øª">
                    <div class="tile-content"><i class="fa-solid fa-mortar-pestle"></i><h2>Ø§Ø¯ÙˆÛŒÙ‡â€ŒØ¬Ø§Øª</h2></div>
                </div>
                <div class="category-tile cat-liquids" data-category="Ø¹Ø±Ù‚ÛŒØ§Øª">
                    <div class="tile-content"><i class="fa-solid fa-bottle-droplet"></i><h2>Ø¹Ø±Ù‚ÛŒØ§Øª</h2></div>
                </div>
                <div class="category-tile cat-oils" data-category="Ø±ÙˆØºÙ†-Ù‡Ø§">
                    <div class="tile-content"><i class="fa-solid fa-oil-well"></i><h2>Ø±ÙˆØºÙ†â€ŒÙ‡Ø§</h2></div>
                </div>
                <div class="category-tile cat-grains" data-category="Ø­Ø¨ÙˆØ¨Ø§Øª-Ùˆ-ØºÙ„Ø§Øª">
                    <div class="tile-content"><i class="fa-solid fa-wheat-awn"></i><h2>Ø­Ø¨ÙˆØ¨Ø§Øª</h2></div>
                </div>
                <div class="category-tile cat-hygiene" data-category="Ø´ÙˆÛŒÙ†Ø¯Ù‡-Ùˆ-Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ">
                    <div class="tile-content"><i class="fa-solid fa-pump-soap"></i><h2>Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ</h2></div>
                </div>
                <div class="category-tile cat-food" data-category="Ù…Ø­ØµÙˆÙ„Ø§Øª-Ø®ÙˆØ±Ø§Ú©ÛŒ">
                    <div class="tile-content"><i class="fa-solid fa-jar"></i><h2>Ø®ÙˆØ±Ø§Ú©ÛŒ</h2></div>
                </div>
                <div class="category-tile cat-misc" data-category="Ù…ØªÙØ±Ù‚Ù‡">
                    <div class="tile-content"><i class="fa-solid fa-box-open"></i><h2>Ø³Ø§ÛŒØ±</h2></div>
                </div>
            </div>
        </div>

        <!-- Ù†Ù…Ø§ÛŒ Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ -->
        <div id="product-view" class="inner-section">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§</button>
            <h2 id="product-category-title" style="margin-top: 0; color: var(--primary-color); font-family: 'Lalezar', cursive;"></h2>
            <div id="loading">Ø¯Ø±Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
            <ul id="product-list" class="product-list"></ul>
        </div>

        <!-- Ù†Ù…Ø§ÛŒ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ -->
        <div id="special-request-view" class="inner-section">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª</button>
            <h2 style="font-family: 'Lalezar'; color: #203a43;">Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ú©Ù…ÛŒØ§Ø¨</h2>
            <p style="font-size: 0.9rem; color: #666;">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.</p>
            
            <div class="special-form">
                <div class="form-group">
                    <label>Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„:</label>
                    <input type="text" id="special-name" class="form-control" placeholder="Ù…Ø«Ù„Ø§Ù‹: ØµÙ…Øº Ø¹Ø±Ø¨ÛŒ Ø§ØµÙ„">
                </div>
                <div class="form-group">
                    <label>ØªÙˆØ¶ÛŒØ­Ø§Øª Ùˆ Ù…Ù‚Ø¯Ø§Ø± (ÙˆØ²Ù†):</label>
                    <input type="text" id="special-details" class="form-control" placeholder="Ù…Ø«Ù„Ø§Ù‹: ÛµÛ°Û° Ú¯Ø±Ù…ØŒ Ø®Ø§Ù„Øµ Ø¨Ø§Ø´Ø¯">
                </div>
                <button class="btn-submit-special" onclick="sendSpecialRequest()">
                    <i class="fab fa-whatsapp"></i> Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾
                </button>
            </div>
        </div>

        <!-- Ù†Ù…Ø§ÛŒ Ù…ÛŒÚ©Ø³Ø± Ø§Ø±Ú¯Ø§Ù†ÛŒÚ© (Ø¨Ø§Ø²ÛŒ) -->
        <div id="mixer-view" class="inner-section" style="background: #fff5f8;">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª</button>
            <h2 style="font-family: 'Lalezar'; color: #9733EE; text-align: center;">Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ©</h2>
            <p style="text-align: center; font-size: 0.85rem; color: #666;">Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ú©Ø´ÛŒØ¯ Ùˆ Ø¯Ø± Ø¸Ø±Ù Ø±Ù‡Ø§ Ú©Ù†ÛŒØ¯ ØªØ§ ØªØ±Ú©ÛŒØ¨ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø³Ø§Ø²ÛŒØ¯.<br>(Ù‡Ø± ÙˆØ§Ø­Ø¯ = ÛµÛ° Ú¯Ø±Ù…)</p>
            
            <div class="mixer-container">
                <!-- Ø´Ù„Ù Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§ -->
                <div class="supplements-shelf" id="shelf"></div>

                <!-- Ù…Ù†Ø·Ù‚Ù‡ ØªØ±Ú©ÛŒØ¨ -->
                <div class="mixing-area">
                    <div class="flask-container" id="flask-target">
                        <div class="flask-neck"></div>
                        <div class="flask-glass" id="flask-content">
                            <!-- Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                        </div>
                        <div class="flask-stats"><span id="current-weight">0</span>g</div>
                    </div>
                </div>

                <div class="completed-mixes">
                    <h4 style="margin: 0 0 10px 0; color: #555;">ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡:</h4>
                    <div id="mix-list">
                        <small style="color: #999;">Ù‡Ù†ÙˆØ² ØªØ±Ú©ÛŒØ¨ÛŒ Ø³Ø§Ø®ØªÙ‡ Ù†Ø´Ø¯Ù‡.</small>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Ø¯Ú©Ù…Ù‡ Ø´Ù†Ø§ÙˆØ± Ù†Ù‡Ø§ÛŒÛŒ -->
    <div id="whatsapp-button" class="whatsapp-fab">
        <i class="fab fa-whatsapp"></i>
        <span id="cart-counter" class="cart-counter"></span>
    </div>

    <!-- Ú¯ÙˆØ³Øª Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ú¯ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
    <div id="drag-ghost" class="drag-ghost"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const whatsappNumber = "989918022066";
            
            // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ
            const categoryView = document.getElementById('category-view');
            const productList = document.getElementById('product-list');
            const categoryTitle = document.getElementById('product-category-title');
            const loadingDiv = document.getElementById('loading');
            const whatsappBtn = document.getElementById('whatsapp-button');
            const cartCounter = document.getElementById('cart-counter');
            const searchInput = document.getElementById('search-input');

            let allProducts = [];
            let shoppingCart = []; 
            let mixedProducts = []; // Ø¢Ø±Ø§ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…ÛŒÚ©Ø³ Ø´Ø¯Ù‡

            // --- Ù…Ø¯ÛŒØ±ÛŒØª ÙˆÛŒÙˆÙ‡Ø§ ---
            window.showCategoryView = function() {
                document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                categoryView.style.display = 'block';
                window.scrollTo(0, 0);
            }

            window.showSection = function(id) {
                categoryView.style.display = 'none';
                document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                document.getElementById(id).style.display = 'block';
                window.scrollTo(0, 0);
            }

            // --- Ù„Ø§Ø¬ÛŒÚ© Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ ---
            function updateCartAndButton() {
                // Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ú†Ú©â€ŒØ¨Ø§Ú©Ø³ Ø¯Ø§Ø±
                const standardItems = [];
                document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                    const name = checkbox.dataset.name;
                    const unit = checkbox.dataset.unit;
                    const quantityInput = document.getElementById(`qty-${name}`);
                    const quantity = quantityInput.value || 1;
                    standardItems.push({ name, quantity, unit, type: 'standard' });
                });

                // ØªØ±Ú©ÛŒØ¨ Ù„ÛŒØ³Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ + Ù…ÛŒÚ©Ø³â€ŒÙ‡Ø§
                shoppingCart = [...standardItems, ...mixedProducts];

                if (shoppingCart.length > 0) {
                    whatsappBtn.classList.add('visible');
                    cartCounter.textContent = shoppingCart.length;
                } else {
                    whatsappBtn.classList.remove('visible');
                }
            }

            function renderProductList(productsToShow, title) {
                productList.innerHTML = '';
                categoryTitle.textContent = title;
                loadingDiv.style.display = 'none';

                if (productsToShow.length === 0) {
                    productList.innerHTML = '<li style="text-align:center; color:#777; padding:20px;">Ù…Ø­ØµÙˆÙ„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</li>';
                    return;
                }
                
                productsToShow.sort((a, b) => a.name.localeCompare(b.name, 'fa'));

                productsToShow.forEach(product => {
                    const listItem = document.createElement('li');
                    listItem.className = 'product-item';
                    
                    // Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ø¢ÛŒØ§ Ø¯Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ (Ø¨Ø®Ø´ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯) Ù‡Ø³Øª ÛŒØ§ Ù†Ù‡
                    const cartItem = shoppingCart.find(item => item.name === product.name && item.type === 'standard');
                    const isSelected = !!cartItem;
                    if(isSelected) listItem.classList.add('selected');

                    if (product.available) {
                        listItem.innerHTML = `
                            <input type="checkbox" class="product-checkbox" id="prod-${product.name}" 
                                   data-name="${product.name}" data-unit="${product.unit || 'Ø¹Ø¯Ø¯'}" ${isSelected ? 'checked' : ''}>
                            
                            <label for="prod-${product.name}" class="product-name">${product.name}</label>
                            
                            <div class="quantity-input-container">
                                <input type="number" min="1" class="quantity-input" 
                                       id="qty-${product.name}" value="${cartItem ? cartItem.quantity : '1'}"
                                       oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                <span style="font-size:0.8rem; color:#888;">${product.unit || 'Ø¹Ø¯Ø¯'}</span>
                                <div class="delete-btn"><i class="fa-solid fa-trash-can"></i></div>
                            </div>
                        `;
                    } else {
                        listItem.innerHTML = `
                            <span class="product-name" style="text-decoration: line-through; color: #aaa;">${product.name}</span>
                            <span class="status-badge status-unavailable">Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</span>
                            <div></div>
                        `;
                    }
                    productList.appendChild(listItem);
                });
            }

            // Event Listeners Ù…Ø­ØµÙˆÙ„Ø§Øª
            productList.addEventListener('change', function(e) {
                if (e.target.classList.contains('product-checkbox')) {
                    const listItem = e.target.closest('.product-item');
                    if (e.target.checked) {
                        listItem.classList.add('selected');
                        setTimeout(() => {
                             const input = listItem.querySelector('.quantity-input');
                             if(input) input.focus();
                        }, 50);
                    } else {
                        listItem.classList.remove('selected');
                    }
                    updateCartAndButton();
                }
            });

            productList.addEventListener('click', function(e) {
                if (e.target.closest('.delete-btn')) {
                    const listItem = e.target.closest('.product-item');
                    const checkbox = listItem.querySelector('.product-checkbox');
                    checkbox.checked = false;
                    listItem.classList.remove('selected');
                    updateCartAndButton();
                }
            });

            productList.addEventListener('input', function(e) {
                if(e.target.classList.contains('quantity-input')) updateCartAndButton();
            });

            document.querySelectorAll('.category-tile[data-category]').forEach(tile => {
                tile.addEventListener('click', function() {
                    const category = this.dataset.category;
                    const categoryName = this.querySelector('h2').textContent;
                    const filteredProducts = allProducts.filter(p => p.category === category);
                    renderProductList(filteredProducts, categoryName);
                    showSection('product-view');
                });
            });

            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.trim().toLowerCase();
                if (searchTerm) {
                    document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                    document.getElementById('product-view').style.display = 'block';
                    const searchResults = allProducts.filter(p => p.name.toLowerCase().includes(searchTerm));
                    renderProductList(searchResults, `Ù†ØªØ§ÛŒØ¬: Â«${searchTerm}Â»`);
                } else {
                    showCategoryView();
                }
            });

            // --- Ù„Ø§Ø¬ÛŒÚ© Ø§Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ù†Ù‡Ø§ÛŒÛŒ ---
            whatsappBtn.addEventListener('click', () => {
                updateCartAndButton();
                if (shoppingCart.length === 0) return;
                
                let message = "Ø³Ù„Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯ØŒ Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯:\n\n";
                
                // Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¹Ø§Ø¯ÛŒ
                const standard = shoppingCart.filter(i => i.type === 'standard');
                if(standard.length > 0) {
                    message += "ğŸ“¦ Ù…Ø­ØµÙˆÙ„Ø§Øª:\n";
                    standard.forEach(item => {
                        message += `â–ªï¸ ${item.name}: ${item.quantity} ${item.unit}\n`;
                    });
                }

                // Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…ÛŒÚ©Ø³
                const mixes = shoppingCart.filter(i => i.type === 'mix');
                if(mixes.length > 0) {
                    message += "\nğŸ§ª ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ©:\n";
                    mixes.forEach(item => {
                        message += `â–ªï¸ ${item.name} (${item.quantity} ${item.unit})\n   Ù…Ø­ØªÙˆÛŒØ§Øª: ${item.details}\n`;
                    });
                }

                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, '_blank');
            });

            // --- Fetch Data ---
            fetch('products.json?v=' + Date.now())
                .then(res => res.json())
                .then(data => { allProducts = data; loadingDiv.style.display = 'none'; })
                .catch(err => { 
                    loadingDiv.innerHTML = ''; 
                    // Ø¯ÛŒØªØ§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø± ØµÙˆØ±Øª Ø®Ø·Ø§
                    allProducts = [
                        { name: "Ø¢ÙˆÛŒØ´Ù† Ø´ÛŒØ±Ø§Ø²ÛŒ", category: "Ú¯ÛŒØ§Ù‡Ø§Ù†-Ø¯Ø§Ø±ÙˆÛŒÛŒ", unit: "Ú¯Ø±Ù…", available: true },
                        { name: "Ø²Ø±Ø¯Ú†ÙˆØ¨Ù‡ Ø§Ø¹Ù„Ø§Ø¡", category: "Ø§Ø¯ÙˆÛŒÙ‡-Ø¬Ø§Øª", unit: "Ú¯Ø±Ù…", available: true },
                        { name: "Ú¯Ù„Ø§Ø¨ Ø¯ÙˆØ¢ØªÛŒØ´Ù‡", category: "Ø¹Ø±Ù‚ÛŒØ§Øª", unit: "Ù„ÛŒØªØ±", available: true }
                    ];
                    console.log('Using sample data due to load error');
                });


            // ==========================================
            // === Ù„Ø§Ø¬ÛŒÚ© Ø¨Ø®Ø´ Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ø®Ø§Øµ ===
            // ==========================================
            window.sendSpecialRequest = function() {
                const name = document.getElementById('special-name').value;
                const details = document.getElementById('special-details').value;
                
                if(!name) { alert('Ù„Ø·ÙØ§ Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'); return; }

                const msg = `Ø³Ù„Ø§Ù…ØŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…Ø­ØµÙˆÙ„ Ø®Ø§Øµ Ø¯Ø§Ø±Ù…:\n\nğŸ· Ù†Ø§Ù…: ${name}\nğŸ“ ØªÙˆØ¶ÛŒØ­Ø§Øª/Ù…Ù‚Ø¯Ø§Ø±: ${details}`;
                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`, '_blank');
            }

            // ==========================================
            // === Ù„Ø§Ø¬ÛŒÚ© Ø¨Ø®Ø´ Ù…ÛŒÚ©Ø³Ø± (Gamification) ===
            // ==========================================
            
            let currentFlaskWeight = 0;
            let flaskIngredients = []; // {name, color}
            let mixCounter = 1;
            
            // Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø¬Ø°Ø§Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ú©Ù…Ù„â€ŒÙ‡Ø§
            const jarColors = [
                '#FF6B6B', '#4ECDC4', '#FFE66D', '#FF9F43', '#54A0FF', 
                '#5F27CD', '#C4E538', '#FDA7DF', '#D980FA', '#B53471',
                '#009432', '#F79F1F', '#1B1464', '#EA2027', '#A3CB38',
                '#12CBC4', '#ED4C67', '#B53471', '#833471', '#6F1E51'
            ];

            window.initMixer = function() {
                const shelf = document.getElementById('shelf');
                if(shelf.children.length > 0) return; // Ù‚Ø¨Ù„Ø§ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡

                for(let i=1; i<=20; i++) {
                    const color = jarColors[(i-1) % jarColors.length];
                    const div = document.createElement('div');
                    div.className = 'supplement-jar';
                    div.setAttribute('data-id', i);
                    div.setAttribute('data-name', `Ù…Ú©Ù…Ù„ ${i}`);
                    div.setAttribute('data-color', color);
                    
                    div.innerHTML = `
                        <div class="jar-lid"></div>
                        <div class="jar-body" style="background:${color}"></div>
                        <div class="jar-label">Ù…Ú©Ù…Ù„ ${i}</div>
                    `;
                    
                    // Mouse Events (Desktop)
                    div.draggable = true;
                    div.addEventListener('dragstart', handleDragStart);
                    div.addEventListener('dragend', handleDragEnd);

                    // Touch Events (Mobile) - Custom Implementation
                    div.addEventListener('touchstart', handleTouchStart, {passive: false});
                    div.addEventListener('touchmove', handleTouchMove, {passive: false});
                    div.addEventListener('touchend', handleTouchEnd);

                    shelf.appendChild(div);
                }

                // Ø¯Ø±Ø§Ù¾ Ø²ÙˆÙ† Ø¯Ø³Ú©ØªØ§Ù¾
                const flaskTarget = document.getElementById('flask-target');
                flaskTarget.addEventListener('dragover', (e) => e.preventDefault());
                flaskTarget.addEventListener('drop', handleDrop);
            }

            let draggedItemData = null;
            const ghostEl = document.getElementById('drag-ghost');

            // --- Desktop Drag & Drop ---
            function handleDragStart(e) {
                draggedItemData = {
                    name: this.getAttribute('data-name'),
                    color: this.getAttribute('data-color')
                };
            }
            function handleDragEnd(e) { draggedItemData = null; }
            function handleDrop(e) {
                e.preventDefault();
                if(draggedItemData) addIngredient(draggedItemData);
            }

            // --- Mobile Touch Drag & Drop ---
            function handleTouchStart(e) {
                e.preventDefault(); // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„
                const touch = e.touches[0];
                draggedItemData = {
                    name: this.getAttribute('data-name'),
                    color: this.getAttribute('data-color')
                };
                
                // ØªÙ†Ø¸ÛŒÙ… Ø¸Ø§Ù‡Ø± Ú¯ÙˆØ³Øª
                ghostEl.style.display = 'flex';
                ghostEl.style.background = draggedItemData.color;
                ghostEl.innerHTML = '<i class="fa-solid fa-cube"></i>';
                moveGhost(touch.clientX, touch.clientY);
            }

            function handleTouchMove(e) {
                e.preventDefault();
                const touch = e.touches[0];
                moveGhost(touch.clientX, touch.clientY);
            }

            function handleTouchEnd(e) {
                ghostEl.style.display = 'none';
                const touch = e.changedTouches[0];
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ø¸Ø±Ù
                const flask = document.getElementById('flask-target');
                const rect = flask.getBoundingClientRect();
                
                if (touch.clientX >= rect.left && touch.clientX <= rect.right &&
                    touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
                    if(draggedItemData) addIngredient(draggedItemData);
                }
                draggedItemData = null;
            }

            function moveGhost(x, y) {
                ghostEl.style.left = (x - 25) + 'px';
                ghostEl.style.top = (y - 25) + 'px';
            }

            // --- Ù„Ø§Ø¬ÛŒÚ© Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¸Ø±Ù ---
            function addIngredient(item) {
                if (currentFlaskWeight >= 1000) {
                    alert("Ø¸Ø±Ù Ù¾Ø± Ø´Ø¯Ù‡ Ø§Ø³Øª! Ù„Ø·ÙØ§Ù‹ ØªØ±Ú©ÛŒØ¨ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ Ù†Ù‡Ø§ÛŒÛŒ Ú©Ù†ÛŒØ¯.");
                    return;
                }

                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙˆØ²Ù†
                currentFlaskWeight += 50;
                document.getElementById('current-weight').textContent = currentFlaskWeight;

                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨ØµØ±ÛŒ Ù„Ø§ÛŒÙ‡
                const layer = document.createElement('div');
                layer.className = 'powder-layer';
                layer.style.height = '5%'; // Ù‡Ø± 50 Ú¯Ø±Ù… = 5 Ø¯Ø±ØµØ¯ Ø§Ø² 1000 Ú¯Ø±Ù…
                layer.style.backgroundColor = item.color;
                document.getElementById('flask-content').appendChild(layer);

                // Ø°Ø®ÛŒØ±Ù‡ Ø¯ÛŒØªØ§
                flaskIngredients.push(item.name);

                // Ú†Ú© Ú©Ø±Ø¯Ù† Ù¾Ø± Ø´Ø¯Ù†
                if (currentFlaskWeight >= 1000) {
                    setTimeout(finishMixing, 500);
                }
            }

            function finishMixing() {
                const mixName = `ØªØ±Ú©ÛŒØ¨ Ø§Ø®ØªØµØ§ØµÛŒ Ø´Ù…Ø§Ø±Ù‡ ${mixCounter}`;
                // Ø³Ø§Ø®ØªÙ† Ø±Ø´ØªÙ‡ Ø¬Ø²Ø¦ÛŒØ§Øª (Ø®Ù„Ø§ØµÙ‡ Ù…ÙˆØ§Ø¯)
                const counts = {};
                flaskIngredients.forEach(x => { counts[x] = (counts[x] || 0) + 1; });
                let detailsStr = Object.entries(counts).map(([key, val]) => `${key} (${val*50}g)`).join('ØŒ ');

                // Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ Ø³Ø¨Ø¯
                mixedProducts.push({
                    name: mixName,
                    quantity: 1, // ÛŒÚ© Ø¸Ø±Ù
                    unit: "Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…",
                    type: "mix",
                    details: detailsStr
                });

                // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù„ÛŒØ³Øª Ù¾Ø§ÛŒÛŒÙ† Ù…ÛŒÚ©Ø³Ø±
                const list = document.getElementById('mix-list');
                if(mixCounter === 1) list.innerHTML = ''; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…ØªÙ† Ù¾ÛŒØ´â€ŒÙØ±Ø¶
                
                const div = document.createElement('div');
                div.className = 'mix-item';
                div.innerHTML = `<span>${mixName}</span> <i class="fa-solid fa-check-circle" style="color:green;"></i>`;
                list.appendChild(div);

                // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù† Ø¸Ø±Ù
                mixCounter++;
                currentFlaskWeight = 0;
                flaskIngredients = [];
                document.getElementById('flask-content').innerHTML = '';
                document.getElementById('current-weight').textContent = '0';
                
                alert(`Ø¸Ø±Ù Ù¾Ø± Ø´Ø¯! "${mixName}" Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`);
                updateCartAndButton();
            }

        });
    </script>
</body>
</html>
